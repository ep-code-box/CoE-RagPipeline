# π” CoE RAG Pipeline

Git λ ν¬μ§€ν† λ¦¬λ“¤μ„ λ¶„μ„ν•μ—¬ λ ν¬μ§€ν† λ¦¬κ°„ μ—°κ΄€λ„, AST λ¶„μ„, κΈ°μ μ¤ν™ μ •μ  λ¶„μ„μ„ μν–‰ν•λ” RAG νμ΄ν”„λΌμΈμ…λ‹λ‹¤.

## β¨ μ£Όμ” κΈ°λ¥

- **Git λ ν¬μ§€ν† λ¦¬ λ¶„μ„**: μ—¬λ¬ Git μ£Όμ†λ¥Ό λ°›μ•„ μ†μ¤μ½”λ“λ¥Ό μλ™μΌλ΅ ν΄λ΅ ν•κ³  λ¶„μ„
- **AST λ¶„μ„**: Python, JavaScript, Java, TypeScript λ“± μ£Όμ” μ–Έμ–΄μ μ¶”μƒ κµ¬λ¬Έ νΈλ¦¬ λ¶„μ„
- **κΈ°μ μ¤ν™ μ •μ  λ¶„μ„**: μμ΅΄μ„±, ν”„λ μ„μ›ν¬, λΌμ΄λΈλ¬λ¦¬, μ½”λ“ ν’μ§ λ©”νΈλ¦­ λ¶„μ„
- **λ ν¬μ§€ν† λ¦¬κ°„ μ—°κ΄€λ„ λ¶„μ„**: κ³µν†µ μμ΅΄μ„±, μ½”λ“ ν¨ν„΄, μ•„ν‚¤ν…μ² μ μ‚¬μ„± λ¶„μ„
- **JSON κ²°κ³Ό μ €μ¥**: λ¨λ“  λ¶„μ„ κ²°κ³Όλ¥Ό κµ¬μ΅°ν™”λ JSON ν•νƒλ΅ μ €μ¥

## π€ μ‹μ‘ν•κΈ°

### 1. ν™κ²½ μ„¤μ •

```bash
# κ°€μƒ ν™κ²½ ν™μ„±ν™”
source .venv/bin/activate

# μμ΅΄μ„± μ„¤μΉ
pip install -r requirements.txt
```

### 2. μ„λ²„ μ‹¤ν–‰

```bash
python main.py
```

## π“‚ ν”„λ΅μ νΈ κµ¬μ΅°

```
CoE-RagPipeline/
β”β”€β”€ main.py                 # FastAPI λ©”μΈ μ• ν”λ¦¬μΌ€μ΄μ…
β”β”€β”€ models/                 # λ°μ΄ν„° λ¨λΈ μ •μ
β”β”€β”€ analyzers/              # λ¶„μ„ λ¨λ“λ“¤
β”‚   β”β”€β”€ git_analyzer.py     # Git λ ν¬μ§€ν† λ¦¬ λ¶„μ„
β”‚   β”β”€β”€ ast_analyzer.py     # AST λ¶„μ„
β”‚   β”β”€β”€ tech_analyzer.py    # κΈ°μ μ¤ν™ λ¶„μ„
β”‚   β””β”€β”€ correlation_analyzer.py # μ—°κ΄€λ„ λ¶„μ„
β”β”€β”€ utils/                  # μ ν‹Έλ¦¬ν‹° ν•¨μλ“¤
β””β”€β”€ output/                 # λ¶„μ„ κ²°κ³Ό μ €μ¥ λ””λ ‰ν† λ¦¬
β”β”€β”€ services/               # μ„λΉ„μ¤ κ³„μΈµ (Embedding λ“±)
β””β”€β”€ chroma_db/              # ChromaDB λ²΅ν„° μ €μ¥μ†
```

## π”§ API μ—”λ“ν¬μΈνΈ

- **`POST /analyze`**: Git μ£Όμ† λ©λ΅μ„ λ°›μ•„ μ „μ²΄ λ¶„μ„ μν–‰
- **`GET /results/{analysis_id}`**: λ¶„μ„ κ²°κ³Ό μ΅°ν
- **`GET /results`**: λ¨λ“  λ¶„μ„ κ²°κ³Ό λ©λ΅ μ΅°ν
- **`GET /health`**: μ„λΉ„μ¤ μƒνƒ ν™•μΈ

## π§ API ν…μ¤νΈ

### cURL λ…λ Ήμ–΄λ΅ ν…μ¤νΈ

μλ™ν™”λ ν…μ¤νΈ μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•μ„Έμ”:

```bash
# μ‹¤ν–‰ κ¶ν• λ¶€μ—¬
chmod +x test_curl.sh

# ν…μ¤νΈ μ‹¤ν–‰
./test_curl.sh
```

λλ” κ°λ³„ cURL λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ„Έμ”:

```bash
# Health Check
curl -X GET "http://127.0.0.1:8001/health"

# λ¶„μ„ μ‹μ‘
curl -X POST "http://127.0.0.1:8001/analyze" \
  -H "Content-Type: application/json" \
  -d '{
    "repositories": [
      {
        "url": "https://github.com/octocat/Hello-World.git",
        "branch": "master"
      }
    ],
    "include_ast": true,
    "include_tech_spec": true,
    "include_correlation": false
  }'

# λ¶„μ„ κ²°κ³Ό μ΅°ν (analysis_idλ” μ„ μ‘λ‹µμ—μ„ λ°›μ€ κ°’ μ‚¬μ©)
curl -X GET "http://127.0.0.1:8001/results/{analysis_id}"

# λ¨λ“  λ¶„μ„ κ²°κ³Ό λ©λ΅
curl -X GET "http://127.0.0.1:8001/results"
```

μμ„Έν• ν…μ¤νΈ λ…λ Ήμ–΄λ” [`curl_test_commands.md`](curl_test_commands.md) νμΌμ„ μ°Έκ³ ν•μ„Έμ”.

### Python μ¤ν¬λ¦½νΈλ΅ ν…μ¤νΈ

```bash
python test_api.py
```

## π”§ λ¬Έμ  ν•΄κ²°

### 404 μ—λ¬ "λ¶„μ„ κ²°κ³Όλ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤"

μ΄ μ—λ¬κ°€ λ°μƒν•λ” κ²½μ° λ‹¤μμ„ ν™•μΈν•μ„Έμ”:

1. **μ¬λ°”λ¥Έ analysis_id μ‚¬μ©**: λ¶„μ„ μ‹μ‘ μ‹ λ°ν™λ μ •ν™•ν• analysis_idλ¥Ό μ‚¬μ©ν•κ³  μλ”μ§€ ν™•μΈ
2. **λ¶„μ„ μƒνƒ ν™•μΈ**: `/results` μ—”λ“ν¬μΈνΈλ΅ μ‚¬μ© κ°€λ¥ν• λ¶„μ„ κ²°κ³Ό λ©λ΅ ν™•μΈ
3. **λ¶„μ„ μ™„λ£ λ€κΈ°**: λ¶„μ„μ΄ μ™„λ£λ  λ•κΉμ§€ μ¶©λ¶„ν κΈ°λ‹¤λ¦° ν›„ κ²°κ³Ό μ΅°ν
4. **μ„λ²„ μ¬μ‹μ‘**: μ΄μ  λ¶„μ„ κ²°κ³Όκ°€ `output/results/` λ””λ ‰ν† λ¦¬μ— JSON νμΌλ΅ μ €μ¥λμ–΄ μ„λ²„ μ¬μ‹μ‘ ν›„μ—λ„ μ μ§€λ©λ‹λ‹¤

### κ°μ„ λ μ—λ¬ λ©”μ‹μ§€

404 μ—λ¬ λ°μƒ μ‹ λ‹¤μκ³Ό κ°™μ€ μƒμ„Έν• μ •λ³΄λ¥Ό μ κ³µν•©λ‹λ‹¤:

```json
{
  "detail": {
    "message": "λ¶„μ„ κ²°κ³Όλ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤.",
    "analysis_id": "μ”μ²­ν•-λ¶„μ„-ID",
    "available_analysis_ids": ["μ‚¬μ©κ°€λ¥ν•-ID-λ©λ΅"],
    "total_available": 1,
    "suggestions": [
      "1. μ¬λ°”λ¥Έ analysis_idλ¥Ό μ‚¬μ©ν•κ³  μλ”μ§€ ν™•μΈν•μ„Έμ”.",
      "2. /results μ—”λ“ν¬μΈνΈλ΅ μ‚¬μ© κ°€λ¥ν• λ¶„μ„ κ²°κ³Ό λ©λ΅μ„ ν™•μΈν•μ„Έμ”.",
      "3. λ¶„μ„μ΄ μ•„μ§ μ§„ν–‰ μ¤‘μ΄κ±°λ‚ μ‹¤ν¨ν–μ„ μ μμµλ‹λ‹¤.",
      "4. λ¶„μ„ ID ν•μ‹μ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈν•μ„Έμ” (UUID ν•μ‹)."
    ]
  }
}
```

### μκµ¬ μ €μ¥μ†

- λ¨λ“  λ¶„μ„ κ²°κ³Όλ” `output/results/` λ””λ ‰ν† λ¦¬μ— JSON νμΌλ΅ μ €μ¥λ©λ‹λ‹¤
- μ„λ²„ μ¬μ‹μ‘ μ‹ μλ™μΌλ΅ κΈ°μ΅΄ λ¶„μ„ κ²°κ³Όλ¥Ό λ΅λ“ν•©λ‹λ‹¤
- λ¶„μ„ μ™„λ£ λ° μ‹¤ν¨ μ‹ λ¨λ‘ κ²°κ³Όκ°€ μ €μ¥λ©λ‹λ‹¤